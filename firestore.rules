
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Admin-only collections: only authenticated users can read/write
    match /branches/{branchId} {
      allow read, write: if request.auth != null;
    }
    
    // Election Rooms: Admins can manage, anyone can read for voting
    match /electionRooms/{roomId} {
      allow read: if true;
      allow write: if request.auth != null;

      // Voters subcollection: Anyone can create their own voter doc, admins can manage
      match /voters/{voterId} {
        allow read, update, delete: if request.auth != null;
        allow create: if true;
      }
      
      // Votes and Reviews subcollections: Anyone can create, admins can read
      match /votes/{voteId} {
        allow read: if true;
        allow create: if true;
        allow write, delete: if request.auth != null;
      }

      match /reviews/{reviewId} {
        allow read: if true;
        allow create: if true;
        allow write, delete: if request.auth != null;
      }
    }
  }
}
